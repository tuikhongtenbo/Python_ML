2025-11-27 12:37:02,864 - lstm_trainer - INFO - Starting training for 30 epochs
2025-11-27 12:37:02,865 - lstm_trainer - INFO - Device: cuda
2025-11-27 12:37:02,865 - lstm_trainer - INFO - Model parameters: 3,400,963
2025-11-27 12:37:02,865 - lstm_trainer - INFO - 
Epoch 1/30
2025-11-27 12:37:17,312 - lstm_trainer - INFO - Train Loss: 0.7330
2025-11-27 12:37:17,312 - lstm_trainer - INFO - Dev Loss: 0.5738, Dev F1: 0.5354, Dev Accuracy: 0.7846
2025-11-27 12:37:17,405 - lstm_trainer - INFO - Saved best model with F1: 0.5354
2025-11-27 12:37:17,405 - lstm_trainer - INFO - 
Epoch 2/30
2025-11-27 12:37:31,528 - lstm_trainer - INFO - Train Loss: 0.4203
2025-11-27 12:37:31,529 - lstm_trainer - INFO - Dev Loss: 0.3396, Dev F1: 0.6047, Dev Accuracy: 0.8863
2025-11-27 12:37:31,609 - lstm_trainer - INFO - Saved best model with F1: 0.6047
2025-11-27 12:37:31,610 - lstm_trainer - INFO - 
Epoch 3/30
2025-11-27 12:37:45,742 - lstm_trainer - INFO - Train Loss: 0.3117
2025-11-27 12:37:45,742 - lstm_trainer - INFO - Dev Loss: 0.3257, Dev F1: 0.6117, Dev Accuracy: 0.8964
2025-11-27 12:37:45,822 - lstm_trainer - INFO - Saved best model with F1: 0.6117
2025-11-27 12:37:45,822 - lstm_trainer - INFO - 
Epoch 4/30
2025-11-27 12:37:59,951 - lstm_trainer - INFO - Train Loss: 0.2639
2025-11-27 12:37:59,951 - lstm_trainer - INFO - Dev Loss: 0.2931, Dev F1: 0.6253, Dev Accuracy: 0.9033
2025-11-27 12:38:00,029 - lstm_trainer - INFO - Saved best model with F1: 0.6253
2025-11-27 12:38:00,029 - lstm_trainer - INFO - 
Epoch 5/30
2025-11-27 12:38:14,357 - lstm_trainer - INFO - Train Loss: 0.2397
2025-11-27 12:38:14,357 - lstm_trainer - INFO - Dev Loss: 0.2947, Dev F1: 0.6295, Dev Accuracy: 0.8977
2025-11-27 12:38:14,433 - lstm_trainer - INFO - Saved best model with F1: 0.6295
2025-11-27 12:38:14,434 - lstm_trainer - INFO - 
Epoch 6/30
2025-11-27 12:38:28,805 - lstm_trainer - INFO - Train Loss: 0.2159
2025-11-27 12:38:28,805 - lstm_trainer - INFO - Dev Loss: 0.2862, Dev F1: 0.6885, Dev Accuracy: 0.9046
2025-11-27 12:38:28,883 - lstm_trainer - INFO - Saved best model with F1: 0.6885
2025-11-27 12:38:28,883 - lstm_trainer - INFO - 
Epoch 7/30
2025-11-27 12:38:43,129 - lstm_trainer - INFO - Train Loss: 0.1804
2025-11-27 12:38:43,129 - lstm_trainer - INFO - Dev Loss: 0.3156, Dev F1: 0.7184, Dev Accuracy: 0.9021
2025-11-27 12:38:43,211 - lstm_trainer - INFO - Saved best model with F1: 0.7184
2025-11-27 12:38:43,212 - lstm_trainer - INFO - 
Epoch 8/30
2025-11-27 12:38:57,236 - lstm_trainer - INFO - Train Loss: 0.1671
2025-11-27 12:38:57,236 - lstm_trainer - INFO - Dev Loss: 0.2929, Dev F1: 0.7500, Dev Accuracy: 0.9116
2025-11-27 12:38:57,314 - lstm_trainer - INFO - Saved best model with F1: 0.7500
2025-11-27 12:38:57,315 - lstm_trainer - INFO - 
Epoch 9/30
2025-11-27 12:39:11,332 - lstm_trainer - INFO - Train Loss: 0.1448
2025-11-27 12:39:11,332 - lstm_trainer - INFO - Dev Loss: 0.2862, Dev F1: 0.7708, Dev Accuracy: 0.9090
2025-11-27 12:39:11,411 - lstm_trainer - INFO - Saved best model with F1: 0.7708
2025-11-27 12:39:11,411 - lstm_trainer - INFO - 
Epoch 10/30
2025-11-27 12:39:25,446 - lstm_trainer - INFO - Train Loss: 0.1205
2025-11-27 12:39:25,446 - lstm_trainer - INFO - Dev Loss: 0.3111, Dev F1: 0.7250, Dev Accuracy: 0.9109
2025-11-27 12:39:25,446 - lstm_trainer - INFO - 
Epoch 11/30
2025-11-27 12:39:39,494 - lstm_trainer - INFO - Train Loss: 0.1061
2025-11-27 12:39:39,494 - lstm_trainer - INFO - Dev Loss: 0.3135, Dev F1: 0.7828, Dev Accuracy: 0.9191
2025-11-27 12:39:39,572 - lstm_trainer - INFO - Saved best model with F1: 0.7828
2025-11-27 12:39:39,572 - lstm_trainer - INFO - 
Epoch 12/30
2025-11-27 12:39:53,558 - lstm_trainer - INFO - Train Loss: 0.0980
2025-11-27 12:39:53,558 - lstm_trainer - INFO - Dev Loss: 0.3318, Dev F1: 0.7652, Dev Accuracy: 0.9103
2025-11-27 12:39:53,558 - lstm_trainer - INFO - 
Epoch 13/30
2025-11-27 12:40:07,614 - lstm_trainer - INFO - Train Loss: 0.0873
2025-11-27 12:40:07,614 - lstm_trainer - INFO - Dev Loss: 0.3400, Dev F1: 0.7763, Dev Accuracy: 0.9172
2025-11-27 12:40:07,614 - lstm_trainer - INFO - 
Epoch 14/30
2025-11-27 12:40:21,676 - lstm_trainer - INFO - Train Loss: 0.0734
2025-11-27 12:40:21,676 - lstm_trainer - INFO - Dev Loss: 0.3447, Dev F1: 0.7897, Dev Accuracy: 0.9135
2025-11-27 12:40:21,758 - lstm_trainer - INFO - Saved best model with F1: 0.7897
2025-11-27 12:40:21,758 - lstm_trainer - INFO - 
Epoch 15/30
2025-11-27 12:40:35,801 - lstm_trainer - INFO - Train Loss: 0.0639
2025-11-27 12:40:35,801 - lstm_trainer - INFO - Dev Loss: 0.4290, Dev F1: 0.7751, Dev Accuracy: 0.9059
2025-11-27 12:40:35,801 - lstm_trainer - INFO - 
Epoch 16/30
2025-11-27 12:40:49,853 - lstm_trainer - INFO - Train Loss: 0.0527
2025-11-27 12:40:49,853 - lstm_trainer - INFO - Dev Loss: 0.3616, Dev F1: 0.7441, Dev Accuracy: 0.8964
2025-11-27 12:40:49,853 - lstm_trainer - INFO - 
Epoch 17/30
2025-11-27 12:41:03,933 - lstm_trainer - INFO - Train Loss: 0.0507
2025-11-27 12:41:03,933 - lstm_trainer - INFO - Dev Loss: 0.4351, Dev F1: 0.7797, Dev Accuracy: 0.9122
2025-11-27 12:41:03,933 - lstm_trainer - INFO - 
Epoch 18/30
2025-11-27 12:41:18,012 - lstm_trainer - INFO - Train Loss: 0.0469
2025-11-27 12:41:18,012 - lstm_trainer - INFO - Dev Loss: 0.4370, Dev F1: 0.7825, Dev Accuracy: 0.9116
2025-11-27 12:41:18,012 - lstm_trainer - INFO - 
Epoch 19/30
2025-11-27 12:41:32,008 - lstm_trainer - INFO - Train Loss: 0.0486
2025-11-27 12:41:32,008 - lstm_trainer - INFO - Dev Loss: 0.4161, Dev F1: 0.7724, Dev Accuracy: 0.9078
2025-11-27 12:41:32,008 - lstm_trainer - INFO - 
Epoch 20/30
2025-11-27 12:41:46,057 - lstm_trainer - INFO - Train Loss: 0.0557
2025-11-27 12:41:46,057 - lstm_trainer - INFO - Dev Loss: 0.4417, Dev F1: 0.7752, Dev Accuracy: 0.9160
2025-11-27 12:41:46,057 - lstm_trainer - INFO - 
Epoch 21/30
2025-11-27 12:42:00,081 - lstm_trainer - INFO - Train Loss: 0.0681
2025-11-27 12:42:00,081 - lstm_trainer - INFO - Dev Loss: 0.4431, Dev F1: 0.7772, Dev Accuracy: 0.9059
2025-11-27 12:42:00,081 - lstm_trainer - INFO - 
Epoch 22/30
2025-11-27 12:42:14,154 - lstm_trainer - INFO - Train Loss: 0.0365
2025-11-27 12:42:14,155 - lstm_trainer - INFO - Dev Loss: 0.5192, Dev F1: 0.7729, Dev Accuracy: 0.9071
2025-11-27 12:42:14,155 - lstm_trainer - INFO - 
Epoch 23/30
2025-11-27 12:42:28,241 - lstm_trainer - INFO - Train Loss: 0.0287
2025-11-27 12:42:28,241 - lstm_trainer - INFO - Dev Loss: 0.5357, Dev F1: 0.7699, Dev Accuracy: 0.9084
2025-11-27 12:42:28,241 - lstm_trainer - INFO - 
Epoch 24/30
2025-11-27 12:42:42,262 - lstm_trainer - INFO - Train Loss: 0.0304
2025-11-27 12:42:42,262 - lstm_trainer - INFO - Dev Loss: 0.5123, Dev F1: 0.7763, Dev Accuracy: 0.9065
2025-11-27 12:42:42,262 - lstm_trainer - INFO - 
Epoch 25/30
2025-11-27 12:42:56,288 - lstm_trainer - INFO - Train Loss: 0.0361
2025-11-27 12:42:56,288 - lstm_trainer - INFO - Dev Loss: 0.4733, Dev F1: 0.7673, Dev Accuracy: 0.9033
2025-11-27 12:42:56,288 - lstm_trainer - INFO - 
Epoch 26/30
2025-11-27 12:43:10,324 - lstm_trainer - INFO - Train Loss: 0.0343
2025-11-27 12:43:10,324 - lstm_trainer - INFO - Dev Loss: 0.5225, Dev F1: 0.7645, Dev Accuracy: 0.9027
2025-11-27 12:43:10,324 - lstm_trainer - INFO - 
Epoch 27/30
2025-11-27 12:43:24,359 - lstm_trainer - INFO - Train Loss: 0.0339
2025-11-27 12:43:24,359 - lstm_trainer - INFO - Dev Loss: 0.5392, Dev F1: 0.7608, Dev Accuracy: 0.9090
2025-11-27 12:43:24,359 - lstm_trainer - INFO - 
Epoch 28/30
2025-11-27 12:43:38,528 - lstm_trainer - INFO - Train Loss: 0.0361
2025-11-27 12:43:38,528 - lstm_trainer - INFO - Dev Loss: 0.4589, Dev F1: 0.7644, Dev Accuracy: 0.9097
2025-11-27 12:43:38,528 - lstm_trainer - INFO - 
Epoch 29/30
2025-11-27 12:43:52,833 - lstm_trainer - INFO - Train Loss: 0.0415
2025-11-27 12:43:52,834 - lstm_trainer - INFO - Dev Loss: 0.5513, Dev F1: 0.7711, Dev Accuracy: 0.9090
2025-11-27 12:43:52,834 - lstm_trainer - INFO - 
Epoch 30/30
2025-11-27 12:44:07,089 - lstm_trainer - INFO - Train Loss: 0.0405
2025-11-27 12:44:07,089 - lstm_trainer - INFO - Dev Loss: 0.5168, Dev F1: 0.7424, Dev Accuracy: 0.9040
2025-11-27 12:44:07,089 - lstm_trainer - INFO - 
Training completed. Best F1: 0.7897
2025-11-27 12:44:07,134 - lstm_trainer - INFO - Loaded model from models/lstm_best_model.pt
2025-11-27 12:44:07,134 - lstm_trainer - INFO - Evaluating on test set...
2025-11-27 12:44:08,693 - lstm_trainer - INFO - Test Loss: 0.4561
2025-11-27 12:44:08,693 - lstm_trainer - INFO - Test F1: 0.7486
2025-11-27 12:44:08,693 - lstm_trainer - INFO - Test Accuracy: 0.8923
2025-11-27 12:44:08,701 - lstm_trainer - INFO - 
Classification Report:
              precision    recall  f1-score   support

    negative       0.90      0.93      0.92      1409
     neutral       0.42      0.40      0.41       167
    positive       0.93      0.91      0.92      1590

    accuracy                           0.89      3166
   macro avg       0.75      0.75      0.75      3166
weighted avg       0.89      0.89      0.89      3166

